<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Hypothesis Tests | Data Analytics with R</title>
  <meta name="description" content="Chapter 5 Hypothesis Tests | Data Analytics with R" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Hypothesis Tests | Data Analytics with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Hypothesis Tests | Data Analytics with R" />
  
  
  

<meta name="author" content="Adam Smith, UCL School of Management" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimation.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting Started with R</a><ul>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#why-use-r"><i class="fa fa-check"></i>Why use R?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#downloading-r-and-rstudio"><i class="fa fa-check"></i>Downloading R and RStudio</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-and-loading-packages"><i class="fa fa-check"></i>Installing and Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html"><i class="fa fa-check"></i><b>1</b> Introduction to Data Analytics</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#loading-and-inspecting-data-sets"><i class="fa fa-check"></i><b>1.1</b> Loading and Inspecting Data Sets</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#statistical-summaries"><i class="fa fa-check"></i><b>1.2</b> Statistical Summaries</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#graphical-summaries"><i class="fa fa-check"></i><b>1.3</b> Graphical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="computing-probabilities.html"><a href="computing-probabilities.html"><i class="fa fa-check"></i><b>2</b> Computing Probabilities</a><ul>
<li class="chapter" data-level="2.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#normal-distribution"><i class="fa fa-check"></i><b>2.1</b> Normal Distribution</a><ul>
<li class="chapter" data-level="2.1.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#probability-density-function-dnorm"><i class="fa fa-check"></i><b>2.1.1</b> Probability Density Function (<code>dnorm</code>)</a></li>
<li class="chapter" data-level="2.1.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#cumulative-distribution-function-pnorm"><i class="fa fa-check"></i><b>2.1.2</b> Cumulative Distribution Function (<code>pnorm</code>)</a></li>
<li class="chapter" data-level="2.1.3" data-path="computing-probabilities.html"><a href="computing-probabilities.html#quantile-function-qnorm"><i class="fa fa-check"></i><b>2.1.3</b> Quantile Function (<code>qnorm</code>)</a></li>
<li class="chapter" data-level="2.1.4" data-path="computing-probabilities.html"><a href="computing-probabilities.html#random-number-generator-rnorm"><i class="fa fa-check"></i><b>2.1.4</b> Random Number Generator (<code>rnorm</code>)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#bernoulli-and-binomial-distributions"><i class="fa fa-check"></i><b>2.2</b> Bernoulli and Binomial Distributions</a><ul>
<li class="chapter" data-level="2.2.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#probability-mass-function-dbinom"><i class="fa fa-check"></i><b>2.2.1</b> Probability Mass Function (<code>dbinom</code>)</a></li>
<li class="chapter" data-level="2.2.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#cumulative-distribution-function-pbinom"><i class="fa fa-check"></i><b>2.2.2</b> Cumulative Distribution Function (<code>pbinom</code>)</a></li>
<li class="chapter" data-level="2.2.3" data-path="computing-probabilities.html"><a href="computing-probabilities.html#quantile-function-qbinom"><i class="fa fa-check"></i><b>2.2.3</b> Quantile Function (<code>qbinom</code>)</a></li>
<li class="chapter" data-level="2.2.4" data-path="computing-probabilities.html"><a href="computing-probabilities.html#random-number-generator-rbinom"><i class="fa fa-check"></i><b>2.2.4</b> Random Number Generator (<code>rbinom</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-distributions-and-the-clt.html"><a href="sampling-distributions-and-the-clt.html"><i class="fa fa-check"></i><b>3</b> Sampling Distributions and the CLT</a></li>
<li class="chapter" data-level="4" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>4</b> Estimation</a><ul>
<li class="chapter" data-level="4.1" data-path="estimation.html"><a href="estimation.html#point-estimation-and-the-mle"><i class="fa fa-check"></i><b>4.1</b> Point Estimation and the MLE</a></li>
<li class="chapter" data-level="4.2" data-path="estimation.html"><a href="estimation.html#confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="4.2.1" data-path="estimation.html"><a href="estimation.html#types-of-confidence-intervals"><i class="fa fa-check"></i><b>4.2.1</b> Types of Confidence Intervals</a></li>
<li class="chapter" data-level="4.2.2" data-path="estimation.html"><a href="estimation.html#examples"><i class="fa fa-check"></i><b>4.2.2</b> Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>5</b> Hypothesis Tests</a><ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#steps-of-hypothesis-testing"><i class="fa fa-check"></i><b>5.1</b> Steps of Hypothesis Testing</a></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#connection-to-confidence-intervals"><i class="fa fa-check"></i><b>5.2</b> Connection to Confidence Intervals</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#hypothesis-testing-in-r"><i class="fa fa-check"></i><b>5.3</b> Hypothesis Testing in R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#linear-regression"><i class="fa fa-check"></i><b>6.1</b> Linear Regression</a></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#regression-trees"><i class="fa fa-check"></i><b>6.2</b> Regression Trees</a></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#model-selection"><i class="fa fa-check"></i><b>6.3</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>7</b> Classification</a><ul>
<li class="chapter" data-level="7.1" data-path="classification.html"><a href="classification.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>7.1</b> <span class="math inline">\(k\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="7.2" data-path="classification.html"><a href="classification.html#logistic-regression"><i class="fa fa-check"></i><b>7.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="7.3" data-path="classification.html"><a href="classification.html#classification-trees"><i class="fa fa-check"></i><b>7.3</b> Classification Trees</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>8</b> Clustering</a><ul>
<li class="chapter" data-level="8.1" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>8.1</b> <span class="math inline">\(k\)</span>-Means</a></li>
<li class="chapter" data-level="8.2" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering"><i class="fa fa-check"></i><b>8.2</b> Hierarchical Clustering</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analytics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-tests" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Hypothesis Tests</h1>
<div id="steps-of-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">5.1</span> Steps of Hypothesis Testing</h2>
<hr>
<p>Statistical hypothesis testing provides a rigorous framework for using data to provide evidence for or against claims.</p>
<p>For example, suppose that you are working for a start-up that develops education software for children. You’re working on a new software package and are now trying to determine how much to charge. Based on experience and market trends, the leadership team thinks £50 is reasonable. As the data scientist, you are asked to do some research.</p>
<p>The plan is for you to conduct a survey to check how much people would be willing to pay for the software. The leadership team will plan to charge £50 unless there is substantial evidence that people are willing to pay more. Your objective is to use the survey data to determine if the company should re-think the £50 price point.</p>
<p>You design a survey and send it to <span class="math inline">\(n=30\)</span> potential customers. After everyone has responded, you find that the average willingess to pay in your sample is <span class="math inline">\(\bar{x}=55.7\)</span> pounds and <span class="math inline">\(s^2=64.8\)</span>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">n =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb135-2" data-line-number="2">xbar =<span class="st"> </span><span class="fl">55.7</span></a>
<a class="sourceLine" id="cb135-3" data-line-number="3">s2 =<span class="st"> </span><span class="fl">64.8</span></a></code></pre></div>
<p>Now, what does this mean? We know that we cannot stop here and conclude that people are willing to pay more than £50 because if we had asked a different group of customers, our sample mean could change (and perhaps be lower than £50).</p>
<p>Our approach will be to carry out a hypothesis test to formally decide what to do.</p>
<p><br>
<strong>Step 1: State the null and alternative hypotheses</strong></p>
<p>The framework of hypothesis testing requires us to specify two mutually exclusive hypotheses: the null hypothesis <span class="math inline">\(H_0\)</span> and the alternative hypothesis <span class="math inline">\(H_1\)</span>. Specifically, we should choose <span class="math inline">\(H_0\)</span> to be the case of “no effect” or “no change” and choose <span class="math inline">\(H_1\)</span> to be the case of what we want to show.</p>
<p>Here, we are investigating whether people are willing to pay <em>more than</em> £50 on average so <span class="math inline">\(\mu&gt;50\)</span> will constitute the alternative.</p>
<p><span class="math display">\[\begin{align*}
H_0:&amp;\ \mu\leq50\\
H_1:&amp;\ \mu&gt;50
\end{align*}\]</span></p>
<p><br>
<strong>Step 2: Choose a test and significance level</strong></p>
<p>To determine which test is appropriate, we must first address the following questions.</p>
<ol style="list-style-type: decimal">
<li>How many parameters do we have? (one = one-sample test, two = two-sample test)</li>
<li>Do we know the population variance? (yes = <span class="math inline">\(z\)</span>-test, no = <span class="math inline">\(t\)</span>-test)</li>
</ol>
<p>In our case, we only have one parameter <span class="math inline">\(\mu\)</span> (the average WTP in the population) and we do not know the population variance, but have an estimate of it in our sample. Therefore, we should use a one-sample <span class="math inline">\(t\)</span>-test.</p>
<p><span class="math display">\[t_{df} = {\bar{X}-\mu\over S/\sqrt{n}}\]</span></p>
<p>Finally, we will choose <span class="math inline">\(\alpha=0.01\)</span> so that we are fairly confident that if we detect deviations from £50, they reflect real deviations in the population.</p>
<p><strong>Step 3: Compute the observed test statistic</strong></p>
<p>Since we are using a one-sample <span class="math inline">\(t\)</span>-test, our observed test statistic is:
<span class="math display">\[t_{obs}={\bar{x}-\mu_0\over s/\sqrt{n}} = {55.7 - 50\over \sqrt{64.8}/\sqrt{30}}=3.878\]</span></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">t_obs =<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span><span class="dv">50</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(s2<span class="op">/</span>n))</a>
<a class="sourceLine" id="cb136-2" data-line-number="2">t_obs</a></code></pre></div>
<pre><code>## [1] 3.878</code></pre>
<p>Our observed test statistic provides a measure of “evidence” against the null hypothesis. In particular, we know that under the null hypothesis, the test statistic follows a <span class="math inline">\(t_{df}=t_{n-1}=t_{29}\)</span> distribution. This distribution (plotted below) represents the distribution of sample evidence given that the null is true. Our observed test statistic (the dashed red line) shows that the event we observed (<span class="math inline">\(\bar{x}=55.7, s^2=64.8\)</span>), seems fairly unlikely under the null.</p>
<p>Our next task will be to compute this probability more formally.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p><br>
<strong>Step 4: Calculate the p-value</strong></p>
<p>The p-value is the probability of getting sample evidence as or more extreme than what we actually observed given that the null hypothesis is actually true. Remember that the test statistic is our measure of “sample evidence” – as the observed test statistic gets large, that will provide more evidence <em>against</em> the null hypothesis.</p>
<p>Since we are working with a “greater-than” alternative, our p-value will be</p>
<p><span class="math display">\[\begin{align*}
\text{p-value} 
&amp;= P(t_{df}&gt;t_{obs}\ | \ H_0 \text{ is true})\\
&amp;= P\left(t_{n-1}&gt;{\bar{x}-\mu_0\over s/\sqrt{n}}\ \big|\ \mu\leq50\right)\\
&amp;= P\left(t_{29}&gt;{55.7 - 50\over \sqrt{64.8}/\sqrt{30}}\right)\\
&amp;= P\left(t_{29}&gt;3.878\right)\\
&amp;\approx 0.0003
\end{align*}\]</span></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="kw">pt</span>(t_obs,<span class="dt">df=</span>n<span class="dv">-1</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.000278</code></pre>
<p>Notice that this value just corresponds to the region to the right of the observed test statistic. Since this probability is so small, it is hard to see the shaded area on the original plot. We can therefore create a “zoomed in” plot next to the original.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p><br>
<strong>Step 4: Make a statistical decision and interpret the results</strong></p>
<p>Once the p-value has been calculated, the “decision rule” can be described as follows.</p>
<p><span class="math display">\[\begin{align*}
\text{ if p-value }\leq \alpha &amp;\ \text{ reject } H_0\\
\text{ if p-value }&gt; \alpha &amp;\ \text{ fail to reject } H_0\\
\end{align*}\]</span></p>
<p>Where does this rule come from? Since <span class="math inline">\(\alpha\)</span> is the maximum p-value at which we reject <span class="math inline">\(H_0\)</span>, then we are ensuring that there is <em>at most</em> a <span class="math inline">\(100\alpha\%\)</span> chance of committing a type I error. That is, if we found the p-value to be large, say 40%, then there would be a 40% chance of mistakenly deciding that the true WTP exceeded £50 when it in fact did not. For most problems, an error rate of 40% is too large to tolerate. In the social sciences, we normally choose <span class="math inline">\(\alpha \in\{0.1, 0.05, 0.01\}\)</span> which corresponds to error rates of 10%, 5%, and 1%.</p>
<p>In the context of this problem, we find the p-value is roughly 0.03%. This means that if the true average WTP in the population is less than £50, there is a 0.03% chance that we would have observed sample evidence as or more extreme than what we did observe (<span class="math inline">\(\bar{x}=55.7, s^2=64.8\)</span>). This is very small – in fact, much smaller than the 5% error rate we can tolerate. Therefore, we decide to reject the null hypothesis and conclude that it is more likely that the true average WTP in the population exceeds £50.</p>
<p>We can take these results back to the leadership team in our company to convince them that they should consider raising the price.</p>
<p><br></p>
</div>
<div id="connection-to-confidence-intervals" class="section level2">
<h2><span class="header-section-number">5.2</span> Connection to Confidence Intervals</h2>
<hr>
<p>There is an intimate connection between hypothesis tests and confidence intervals. We will now go through the details to see why.</p>
<p>To start, remember that our decision rules for hypothesis testing take the following form.</p>
<p><span class="math display">\[\begin{align*}
\text{ if p-value }\leq \alpha &amp;;\ \text{ reject } H_0\\
\text{ if p-value } &gt; \alpha &amp;;\ \text{ fail to reject } H_0\\
\end{align*}\]</span></p>
<p>This can also be described visually. Suppose you carry out a two-sided hypothesis test with <span class="math inline">\(\alpha=0.05\)</span> and compute a test statistic <span class="math inline">\(z_{obs}=2.054\)</span> and a corresponding p-value equal to 0.04. This corresponds to a <em>total</em> area equal to 0.04 in the lower and upper tails of the distribution of the test statistic.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>We can also work out what value (on the x-axis) corresponds to an area of <span class="math inline">\(\alpha/2=0.05/2=0.025\)</span> in the upper tail.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">qnorm</span>(<span class="fl">0.025</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 1.96</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>Now the dotted black line is at the point <span class="math inline">\(z_{\alpha/2}=1.96\)</span> – i.e., the value such that the upper tail area is equal to <span class="math inline">\(\alpha/2=0.025\)</span>. Notice that our shaded area falls to the right of this line, so by our decision rule, we would reject the null.</p>
<p>But, notice that we would reject the null <em>for any</em> test statistic (solid red line) that falls to the right of the critical value <span class="math inline">\(z_{\alpha/2}\)</span> (dotted black line).</p>
<p>Therefore, the following would be an equivalent set of decision rules.</p>
<p><span class="math display">\[\begin{align*}
\text{ if } \big|z_{obs}\big|\geq z_{\alpha/2} &amp;\ \text{ reject } H_0\\
\text{ if } \big|z_{obs}\big| &lt; z_{\alpha/2} &amp;\ \text{ fail to reject } H_0\\
\end{align*}\]</span></p>
<p>Remember that a confidence interval is a range of plausible values, which we can now formally define as the the range of parameter values that would not be rejected by our hypothesis test. In this case, the “acceptance region” is defined as follows.</p>
<p><span class="math display">\[\begin{align*}
\big|z_{obs}\big|&lt; z_{\alpha/2}
&amp;\implies \left|{\bar{x} - \mu_0 \over \sigma/\sqrt{n}}\right|&lt;z_{\alpha/2}\\
&amp;\implies -z_{\alpha/2}&lt;{\bar{x} - \mu_0 \over \sigma/\sqrt{n}}&lt;z_{\alpha/2}\\
&amp;\implies -z_{\alpha/2} \times {\sigma \over \sqrt{n}} &lt;\bar{x} - \mu_0 &lt; z_{\alpha/2} \times {\sigma \over \sqrt{n}}\\
&amp;\implies -\bar{x}-z_{\alpha/2} \times {\sigma \over \sqrt{n}} &lt; - \mu_0 &lt; -\bar{x} + z_{\alpha/2} \times {\sigma \over \sqrt{n}}\\
&amp;\implies \bar{x}-z_{\alpha/2} \times {\sigma \over \sqrt{n}} &lt; \mu_0 &lt; \bar{x} + z_{\alpha/2} \times {\sigma \over \sqrt{n}}
\end{align*}\]</span>
This last line is the exact form of a confidence interval!</p>
<p><br></p>
</div>
<div id="hypothesis-testing-in-r" class="section level2">
<h2><span class="header-section-number">5.3</span> Hypothesis Testing in R</h2>
<hr>
<p>We can use the <code>t.test( )</code> function to carry out both one and two-sample <span class="math inline">\(t\)</span>-tests in R. (Note: There are no built-in <span class="math inline">\(z\)</span>-test functions in R because when we work with real data, we <em>never</em> know the population variance!)</p>
<blockquote>
<p>ONE-SAMPLE <span class="math inline">\(t\)</span>-TEST<br>
<strong><code>t.test(mydata, alternative, mu, conf.level)</code></strong><br>
<code>mydata</code>: data on the variable of interest<br>
<code>alternative</code>: what type of alternative hypothesis is specified? (options: “two.sided”, “greater”, “less”) <br>
<code>mu</code>: the value of <span class="math inline">\(\mu\)</span> under the null hypothesis<br>
<code>conf.level</code>: confidence level of the test (<span class="math inline">\(1-\alpha\)</span>)<br>
<br>
TWO-SAMPLE <span class="math inline">\(t\)</span>-TEST<br>
<strong><code>t.test(mydata1, mydata2, alternative, mu, conf.level)</code></strong><br>
<code>mydata1</code>: data on the first variable of interest<br>
<code>mydata2</code>: data on the second variable of interest<br>
<code>alternative</code>: what type of alternative hypothesis is specified? (options: “two.sided”, “greater”, “less”) <br>
<code>mu</code>: the value of the difference <span class="math inline">\(\mu_1-\mu_2\)</span> under the null hypothesis<br>
<code>conf.level</code>: confidence level of the test (<span class="math inline">\(1-\alpha\)</span>)<br></p>
</blockquote>
<p><strong>PROBLEM 1:</strong> The EuStockMarkets data set in R provides daily closing prices of four major European stock indices: Germany DAX (Ibis), Switzerland SMI, France CAC, and UK FTSE. Using this data set, test to see if there are differences in the closing prices of the SMI and CAC indices. Carry out this test at the 5% significance level and do not assume equal variances.</p>
<details>
<p><summary>Solution:</summary></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="co"># load the data</span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="kw">data</span>(EuStockMarkets)</a>
<a class="sourceLine" id="cb142-3" data-line-number="3"></a>
<a class="sourceLine" id="cb142-4" data-line-number="4"><span class="co"># create the SMI variable which is the second column of the EuStockMarkets data</span></a>
<a class="sourceLine" id="cb142-5" data-line-number="5">SMI =<span class="st"> </span>EuStockMarkets[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb142-6" data-line-number="6"></a>
<a class="sourceLine" id="cb142-7" data-line-number="7"><span class="co"># create the CAC variable which is the third column of the EuStockMarkets data</span></a>
<a class="sourceLine" id="cb142-8" data-line-number="8">CAC =<span class="st"> </span>EuStockMarkets[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb142-9" data-line-number="9"></a>
<a class="sourceLine" id="cb142-10" data-line-number="10"><span class="co"># execute the two-sample t-test</span></a>
<a class="sourceLine" id="cb142-11" data-line-number="11"><span class="kw">t.test</span>(SMI, CAC, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  SMI and CAC
## t = 28, df = 2305, p-value &lt;2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1068 1228
## sample estimates:
## mean of x mean of y 
##      3376      2228</code></pre>
<p>We find a p-value much smaller than <span class="math inline">\(\alpha=0.05\)</span>, so we can reject the null and conclude that there are differences in the closing prices between the Swiss SMI and French CAC stock indices.</p>
</details>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
