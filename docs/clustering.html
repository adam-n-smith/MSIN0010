<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Clustering | Data Analytics with R</title>
  <meta name="description" content="Chapter 8 Clustering | Data Analytics with R" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Clustering | Data Analytics with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Clustering | Data Analytics with R" />
  
  
  

<meta name="author" content="Adam Smith (main text), UCL School of Management" />
<meta name="author" content="Rafael Greminger (2022 updates), UCL School of Management" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="classification.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting Started with R</a>
<ul>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#why-use-r"><i class="fa fa-check"></i>Why use R?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#what-does-r-do"><i class="fa fa-check"></i>What does R do?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#downloading-r-and-rstudio"><i class="fa fa-check"></i>Downloading R and RStudio</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-and-loading-packages"><i class="fa fa-check"></i>Installing and Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html"><i class="fa fa-check"></i><b>1</b> Introduction to Data Analytics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#loading-and-inspecting-data-sets"><i class="fa fa-check"></i><b>1.1</b> Loading and Inspecting Data Sets</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#statistical-summaries"><i class="fa fa-check"></i><b>1.2</b> Statistical Summaries</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-data-analytics.html"><a href="introduction-to-data-analytics.html#graphical-summaries"><i class="fa fa-check"></i><b>1.3</b> Graphical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="computing-probabilities.html"><a href="computing-probabilities.html"><i class="fa fa-check"></i><b>2</b> Computing Probabilities</a>
<ul>
<li class="chapter" data-level="2.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#normal-distribution"><i class="fa fa-check"></i><b>2.1</b> Normal Distribution</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#probability-density-function-dnorm"><i class="fa fa-check"></i><b>2.1.1</b> Probability Density Function (<code>dnorm</code>)</a></li>
<li class="chapter" data-level="2.1.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#cumulative-distribution-function-pnorm"><i class="fa fa-check"></i><b>2.1.2</b> Cumulative Distribution Function (<code>pnorm</code>)</a></li>
<li class="chapter" data-level="2.1.3" data-path="computing-probabilities.html"><a href="computing-probabilities.html#quantile-function-qnorm"><i class="fa fa-check"></i><b>2.1.3</b> Quantile Function (<code>qnorm</code>)</a></li>
<li class="chapter" data-level="2.1.4" data-path="computing-probabilities.html"><a href="computing-probabilities.html#random-number-generator-rnorm"><i class="fa fa-check"></i><b>2.1.4</b> Random Number Generator (<code>rnorm</code>)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#bernoulli-and-binomial-distributions"><i class="fa fa-check"></i><b>2.2</b> Bernoulli and Binomial Distributions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="computing-probabilities.html"><a href="computing-probabilities.html#probability-mass-function-dbinom"><i class="fa fa-check"></i><b>2.2.1</b> Probability Mass Function (<code>dbinom</code>)</a></li>
<li class="chapter" data-level="2.2.2" data-path="computing-probabilities.html"><a href="computing-probabilities.html#cumulative-distribution-function-pbinom"><i class="fa fa-check"></i><b>2.2.2</b> Cumulative Distribution Function (<code>pbinom</code>)</a></li>
<li class="chapter" data-level="2.2.3" data-path="computing-probabilities.html"><a href="computing-probabilities.html#quantile-function-qbinom"><i class="fa fa-check"></i><b>2.2.3</b> Quantile Function (<code>qbinom</code>)</a></li>
<li class="chapter" data-level="2.2.4" data-path="computing-probabilities.html"><a href="computing-probabilities.html#random-number-generator-rbinom"><i class="fa fa-check"></i><b>2.2.4</b> Random Number Generator (<code>rbinom</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-distributions-and-the-clt.html"><a href="sampling-distributions-and-the-clt.html"><i class="fa fa-check"></i><b>3</b> Sampling Distributions and the CLT</a></li>
<li class="chapter" data-level="4" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>4</b> Estimation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estimation.html"><a href="estimation.html#point-estimation-and-the-mle"><i class="fa fa-check"></i><b>4.1</b> Point Estimation and the MLE</a></li>
<li class="chapter" data-level="4.2" data-path="estimation.html"><a href="estimation.html#confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="estimation.html"><a href="estimation.html#types-of-confidence-intervals"><i class="fa fa-check"></i><b>4.2.1</b> Types of Confidence Intervals</a></li>
<li class="chapter" data-level="4.2.2" data-path="estimation.html"><a href="estimation.html#examples"><i class="fa fa-check"></i><b>4.2.2</b> Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>5</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#steps-of-hypothesis-testing"><i class="fa fa-check"></i><b>5.1</b> Steps of Hypothesis Testing</a></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#connection-to-confidence-intervals"><i class="fa fa-check"></i><b>5.2</b> Connection to Confidence Intervals</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#hypothesis-testing-in-r"><i class="fa fa-check"></i><b>5.3</b> Hypothesis Testing in R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#linear-regression"><i class="fa fa-check"></i><b>6.1</b> Linear Regression</a></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#regression-trees"><i class="fa fa-check"></i><b>6.2</b> Regression Trees</a></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#model-selection"><i class="fa fa-check"></i><b>6.3</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>7</b> Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="classification.html"><a href="classification.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>7.1</b> <span class="math inline">\(k\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="7.2" data-path="classification.html"><a href="classification.html#logistic-regression"><i class="fa fa-check"></i><b>7.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="7.3" data-path="classification.html"><a href="classification.html#classification-trees"><i class="fa fa-check"></i><b>7.3</b> Classification Trees</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>8</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.1" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>8.1</b> <span class="math inline">\(k\)</span>-Means</a></li>
<li class="chapter" data-level="8.2" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering"><i class="fa fa-check"></i><b>8.2</b> Hierarchical Clustering</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analytics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Clustering<a href="clustering.html#clustering" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The goal of clustering is to discover groups of similar observations among a set of variables <span class="math inline">\(X_1,\dotsc,X_p\)</span>. Clustering is an example of an <strong>unsupervised learning</strong> method, as we only consider the features <span class="math inline">\(X_1,\dotsc,X_p\)</span> <em>without</em> an associated response <span class="math inline">\(Y\)</span>.</p>
<p>To illustrate clustering methods, we will use the Auto data in the <code>ISLR</code> R library. The data set contains information on the gas mileage, number of cylinders, displacement, horsepower, weight, acceleration, year, and origin for 392 vehicles.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="clustering.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb217-2"><a href="clustering.html#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="clustering.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb217-4"><a href="clustering.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Auto)</span>
<span id="cb217-5"><a href="clustering.html#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Auto)</span></code></pre></div>
<pre><code>## The following objects are masked from Auto (pos = 4):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name, origin,
##     weight, year</code></pre>
<pre><code>## The following object is masked from package:ggplot2:
## 
##     mpg</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="clustering.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect first few rows</span></span>
<span id="cb220-2"><a href="clustering.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Auto)</span></code></pre></div>
<table class="table" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cylinders
</th>
<th style="text-align:right;">
displacement
</th>
<th style="text-align:right;">
horsepower
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
acceleration
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
origin
</th>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
307
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
3504
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
chevrolet chevelle malibu
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
350
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
3693
</td>
<td style="text-align:right;">
11.5
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
buick skylark 320
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
3436
</td>
<td style="text-align:right;">
11.0
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
plymouth satellite
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
304
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
3433
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
amc rebel sst
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
302
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
3449
</td>
<td style="text-align:right;">
10.5
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ford torino
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
198
</td>
<td style="text-align:right;">
4341
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ford galaxie 500
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="k-means" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> <span class="math inline">\(k\)</span>-Means<a href="clustering.html#k-means" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr>
<p>The <span class="math inline">\(k\)</span>-means clustering algorithm uses the variables <span class="math inline">\(X_1,\dotsc,X_p\)</span> to partition our observations <span class="math inline">\(1,\dotsc,n\)</span> into <span class="math inline">\(k\)</span> non-overlapping groups. The partitioning is done based on the similarity of observations, where similarity is measured using <em>Euclidean distance</em>. Consequently, we will need to rescale our data.</p>
<p>We’ll isolate the first seven variables (mpg, cylinders, displacement, horsepower, weight, acceleration, year) and define them as <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="clustering.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select first seven columns of Auto data</span></span>
<span id="cb221-2"><a href="clustering.html#cb221-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> Auto[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb221-3"><a href="clustering.html#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="clustering.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale X&#39;s</span></span>
<span id="cb221-5"><a href="clustering.html#cb221-5" aria-hidden="true" tabindex="-1"></a>stdX <span class="ot">=</span> <span class="fu">scale</span>(X)</span>
<span id="cb221-6"><a href="clustering.html#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="clustering.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set the name of each row to be the car name stored in the Auto data</span></span>
<span id="cb221-8"><a href="clustering.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stdX) <span class="ot">=</span> Auto<span class="sc">$</span>name</span>
<span id="cb221-9"><a href="clustering.html#cb221-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-10"><a href="clustering.html#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the rescaled data</span></span>
<span id="cb221-11"><a href="clustering.html#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stdX)</span></code></pre></div>
<pre><code>##       mpg            cylinders       displacement      horsepower         weight      
##  Min.   :-1.8509   Min.   :-1.449   Min.   :-1.208   Min.   :-1.519   Min.   :-1.607  
##  1st Qu.:-0.8259   1st Qu.:-0.863   1st Qu.:-0.854   1st Qu.:-0.766   1st Qu.:-0.886  
##  Median :-0.0892   Median :-0.863   Median :-0.415   Median :-0.285   Median :-0.205  
##  Mean   : 0.0000   Mean   : 0.000   Mean   : 0.000   Mean   : 0.000   Mean   : 0.000  
##  3rd Qu.: 0.7116   3rd Qu.: 1.482   3rd Qu.: 0.777   3rd Qu.: 0.559   3rd Qu.: 0.750  
##  Max.   : 2.9666   Max.   : 1.482   Max.   : 2.490   Max.   : 3.261   Max.   : 2.546  
##   acceleration         year        
##  Min.   :-2.733   Min.   :-1.6232  
##  1st Qu.:-0.640   1st Qu.:-0.8089  
##  Median :-0.015   Median : 0.0055  
##  Mean   : 0.000   Mean   : 0.0000  
##  3rd Qu.: 0.538   3rd Qu.: 0.8199  
##  Max.   : 3.356   Max.   : 1.6343</code></pre>
<p><br></p>
<p>Let’s start by runing the <span class="math inline">\(k\)</span>-means algorithm with <span class="math inline">\(k=2\)</span> and only using the mpg and horsepower variables.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="clustering.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate clusters</span></span>
<span id="cb223-2"><a href="clustering.html#cb223-2" aria-hidden="true" tabindex="-1"></a>km2 <span class="ot">=</span> <span class="fu">kmeans</span>(stdX[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],<span class="dv">2</span>)</span>
<span id="cb223-3"><a href="clustering.html#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="clustering.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot clusters</span></span>
<span id="cb223-5"><a href="clustering.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km2<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>We can see how the algorithm divides the observations into two groups: the red observations have a high mpg but lower horsepower, while the black observations have a low mpg but high horsepower.</p>
<p>Now let’s try using all seven variables to define the clusters.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="clustering.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate clusters</span></span>
<span id="cb224-2"><a href="clustering.html#cb224-2" aria-hidden="true" tabindex="-1"></a>km2 <span class="ot">=</span> <span class="fu">kmeans</span>(stdX,<span class="dv">2</span>)</span>
<span id="cb224-3"><a href="clustering.html#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="clustering.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot clusters pver mpg and horsepower</span></span>
<span id="cb224-5"><a href="clustering.html#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km2<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>The plot looks similar: even when we use all variables, the first group of cars (black observations) have a low mpg and high horsepower while the second group (red observations) have a high mpg and low horsepower.</p>
<p>The plot above only shows the clustering solution with respect to two variables (mpg and horsepower). To examine how the clusters are defined over all variables, we can use the <code>pairs( )</code> function.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="clustering.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot clusters over all variables</span></span>
<span id="cb225-2"><a href="clustering.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(stdX, <span class="at">col=</span>km2<span class="sc">$</span>cluster, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>Lastly, we can explore clustering solutions for different values of <span class="math inline">\(k\)</span>. For simplicity, we will only examine the clusters for the mpg and horsepower variables.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="clustering.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate clusters</span></span>
<span id="cb226-2"><a href="clustering.html#cb226-2" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">=</span> <span class="fu">kmeans</span>(stdX,<span class="dv">3</span>)</span>
<span id="cb226-3"><a href="clustering.html#cb226-3" aria-hidden="true" tabindex="-1"></a>km4 <span class="ot">=</span> <span class="fu">kmeans</span>(stdX,<span class="dv">4</span>)</span>
<span id="cb226-4"><a href="clustering.html#cb226-4" aria-hidden="true" tabindex="-1"></a>km5 <span class="ot">=</span> <span class="fu">kmeans</span>(stdX,<span class="dv">5</span>)</span>
<span id="cb226-5"><a href="clustering.html#cb226-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-6"><a href="clustering.html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot clusters over mpg and horsepower</span></span>
<span id="cb226-7"><a href="clustering.html#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span>))</span>
<span id="cb226-8"><a href="clustering.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km2<span class="sc">$</span>cluster)</span>
<span id="cb226-9"><a href="clustering.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km3<span class="sc">$</span>cluster)</span>
<span id="cb226-10"><a href="clustering.html#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km4<span class="sc">$</span>cluster)</span>
<span id="cb226-11"><a href="clustering.html#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg, horsepower, <span class="at">col=</span>km5<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>As <span class="math inline">\(k\)</span> increases, we get a more granular picture of car segments. However, the problem of interpretation becomes more difficult: What is it that actually differentiates these clusters from each other? We are only plotting the data over two variables, but the other variables also contribute in the determination of cluster assignments.</p>
<p>Moreover, how should we determine an appropriate value of <span class="math inline">\(k\)</span>? Hierachical clustering provides a partial solution.</p>
<p><br></p>
</div>
<div id="hierarchical-clustering" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Hierarchical Clustering<a href="clustering.html#hierarchical-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr>
<p>Hierarchical clustering addresses the issue of having to choose the number of clusters <span class="math inline">\(k\)</span>, and instead considers a sequence of clusters from <span class="math inline">\(k = 1,\dotsc,n\)</span>. We’ll use the <code>hclust( )</code> function and <code>dendextend</code> package to fit and plot the output from hierarchical clustering models.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="clustering.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span></code></pre></div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="clustering.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate clusters</span></span>
<span id="cb228-2"><a href="clustering.html#cb228-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(X))</span>
<span id="cb228-3"><a href="clustering.html#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="clustering.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot clusters</span></span>
<span id="cb228-5"><a href="clustering.html#cb228-5" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb228-6"><a href="clustering.html#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labels_cex</span>(dend) <span class="ot">=</span> .<span class="dv">25</span></span>
<span id="cb228-7"><a href="clustering.html#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dend)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>Because we have a few hundred observations, the plot – which called a “dendrogram” – becomes difficult to read and interpret on a small scale (meaning we would need a much larger plotting window!).</p>
<p>Suppose we were interested in a two group clustering solution. Then we can simply color the dendrogram based on the first split.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="clustering.html#cb229-1" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb229-2"><a href="clustering.html#cb229-2" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">color_labels</span>(dend,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb229-3"><a href="clustering.html#cb229-3" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">color_branches</span>(dend,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb229-4"><a href="clustering.html#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labels_cex</span>(dend) <span class="ot">=</span> .<span class="dv">25</span></span>
<span id="cb229-5"><a href="clustering.html#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dend)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>We can do the same for a larger number of groups, too.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="clustering.html#cb230-1" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb230-2"><a href="clustering.html#cb230-2" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">color_labels</span>(dend,<span class="at">k=</span><span class="dv">10</span>)</span>
<span id="cb230-3"><a href="clustering.html#cb230-3" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">color_branches</span>(dend,<span class="at">k=</span><span class="dv">10</span>)</span>
<span id="cb230-4"><a href="clustering.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labels_cex</span>(dend) <span class="ot">=</span> .<span class="dv">25</span></span>
<span id="cb230-5"><a href="clustering.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dend)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>Notice that when interpreting a dendrogram, the analyst must still “choose” <span class="math inline">\(k\)</span>, so the problem still hasn’t really gone away. The only benefit with hierarchical clustering methods is that the analyst can quickly and easily examine the landscape of clustering solutions to understand how the value of <span class="math inline">\(k\)</span> impacts different clustering solutions.</p>

</div>
</div>








            </section>

          </div>
        </div>
      </div>
<a href="classification.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
